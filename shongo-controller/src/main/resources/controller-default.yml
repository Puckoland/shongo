# Default Configuration of Domain Controller

---

configuration:
  # Timezone in which the controller should work and which is used as default for date/times without specific timezone
  timezone: UTC

  # Configuration of controlled domain
  domain:
    name: unknown
    organization: Unknown Organization
    # Interdomain protocol listening port
    inter-domain-connection:
#      host: localhost
#      Secure port for interdomain protocol
#      port: ''
#      Use PKI client auth, basic auth otherwise
#      pki-client-auth: 'true'
      command-timeout: PT10S
#      Refresh rate for domains connector cache
      cache-refresh-rate: PT5M
#      TrustStore of JKS/PKCS12 type with private key and certificate chain of local domain
#      ssl-key-store: ''
#      ssl-key-store-type: ''
#      ssl-key-store-password: ''
#      Trusted CA's of foreign domains (PEM)
#      ssl-trust-store:
#        ca-certificate: ''
#      Basic authentication(if PKI is not set)
#      basic-auth:
#        password: ''

  # Database settings
  database:
    driver: org.hsqldb.jdbcDriver
    url: 'jdbc:hsqldb:file:data/controller; shutdown=true; hsqldb.write_delay=false;'
    username: sa
    password: ''

  # Configuration of XML-RPC server
  rpc:
    host: ''
    port: '8181'
    ssl-key-store: ''
    ssl-key-store-password: ''

  # Configuration of Jade container
  jade:
    host: 127.0.0.1
    port: '8282'
    agent-name: Controller
    platform-id: Shongo
    # Timeout to receive response when performing commands from agents
    command-timeout: PT33S

  # Security settings
  security:
    # AA server
    server: 'https://shongo-auth-dev.cesnet.cz/testing'
    # Client ID for AA server
    client-id: shongo-controller
    # Specifies filename where the root access token will be written when controller starts
    root-access-token: root.access-token
    # Specifies authorization cache expiration
    expiration:
      # Expiration of user-id by access-token
      user-id: PT30M
      # Expiration of user information by user-id
      user-information: PT5M
      # Expiration of user ACL by user-id
      acl: PT5M
      # Expiration of user groups
      group: PT5M
    # Authorization expressions
    authorization:
      # Expression for decision whether user can act as administrator
      administrator: group("admins").contains(id)
      # Expression for decision whether user can act as operator
      operator: group("operators").contains(id)
      # Expression for decision whether user can create a new reservation request
      reservation: loa >= 2 || group("reservation").contains(id)
    # For offline purposes - will not fetch user groups
#    authorization:
#      administrator: 'false'
#      operator: 'false'
#      reservation: 'true'

  # Worker periodically starts preprocessor and scheduler
  worker:
    # Period in which the worker is periodically working
    period: PT5S
    # Length of working interval
    lookahead: P31D

  # Executor periodically checks executables for execution
  executor:
    # Period in which the executor is periodically checking executables
    period: PT15S
    # Configuration for each executable
    executable:
      # Period modifying executable starting date/time
      start: PT-30S
      # Period modifying executable ending date/time
      end: PT-30S
      # Period in which the action is repeated if it fails
      next-attempt: PT2M
      # Maximum count of attempts
      max-attempt-count: '15'
    # Configuration of durations which should be reserved for starting executables
    starting-duration:
      # Duration for which the executor waits when a room is being to started
      room: PT5S

  # Reservation configuration
  reservation:
    # Configuration of room reservations
    room:
      # Maximum duration of a room reservation
      max-duration: P1W

  # Configuration for sending emails
  smtp:
    sender: no-reply@shongo.cz
#    host: ''
    port: '25'
#    username: ''
#    password: ''
    # TODO: test this
    subject-prefix: "[#{'$'}{domain.shortName}] "

  # Configuration of notifications
  notification:
#    reservation-request-url: ''
#    user-settings-url: ''
#    reservation-request-confirmation-url: ''

  # Configuration of domain administrators
#  administrator: ''

  # SSL configuration
#  ssl:
#    # Mapping source hostname to different target hostname for certificate hostname verification
    # TODO: test this
#    mapped-hostname:
#      _source: illegal-host-name
#      _target: corrected-host-name
#    # Trusted hostname for certificate hostname verification
#    trusted-hostname: host-name

